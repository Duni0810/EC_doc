(function(A){if(typeof define==="function"&&define.amd){define(["jquery.autocomplete"],A)}else{if(typeof exports==="object"&&typeof require==="function"){A(require("jquery"))}else{A(jQuery)}}}(function(D){var B=(function(){return{escapeRegExChars:function(E){return E.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},createNode:function(E){var F=document.createElement("div");F.className=E;F.style.position="absolute";F.style.display="none";return F}}}()),C={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};function A(E,G){var H=function(){},F=this,I={ajaxSettings:{},autoSelectFirst:false,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:A.formatResult,delimiter:null,zIndex:9999,type:"GET",noCache:false,onSearchStart:H,onSearchComplete:H,onSearchError:H,preserveInput:false,containerClass:"autocomplete-suggestions",tabDisabled:false,dataType:"text",currentRequest:null,triggerSelectOnValidInput:true,preventBadQueries:true,lookupFilter:function(K,L,J){return K.value.toLowerCase().indexOf(J)!==-1},paramName:"query",transformResult:function(J){return typeof J==="string"?D.parseJSON(J):J},showNoSuggestionNotice:false,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:false};F.element=E;F.el=D(E);F.suggestions=[];F.badQueries=[];F.selectedIndex=-1;F.currentValue=F.element.value;F.intervalId=0;F.cachedResponse={};F.onChangeInterval=null;F.onChange=null;F.isLocal=false;F.suggestionsContainer=null;F.noSuggestionsContainer=null;F.options=D.extend({},I,G);F.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"};F.hint=null;F.hintValue="";F.selection=null;F.initialize();F.setOptions(G)}A.utils=B;D.Autocomplete=A;A.formatResult=function(E,G){if(!G){return E.value}var F="("+B.escapeRegExChars(G)+")";return E.value.replace(new RegExp(F,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")};A.prototype={killerFn:null,initialize:function(){var E=this,G="."+E.classes.suggestion,I=E.classes.selected,F=E.options,H;E.element.setAttribute("autocomplete","off");E.killerFn=function(J){if(D(J.target).closest("."+E.options.containerClass).length===0){E.killSuggestions();E.disableKillerFn()}};E.noSuggestionsContainer=D('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0);E.suggestionsContainer=A.utils.createNode(F.containerClass);H=D(E.suggestionsContainer);H.appendTo(F.appendTo);if(F.width!=="auto"){H.width(F.width)}H.on("mouseover.autocomplete",G,function(){E.activate(D(this).data("index"))});H.on("mouseout.autocomplete",function(){E.selectedIndex=-1;H.children("."+I).removeClass(I)});H.on("click.autocomplete",G,function(){E.select(D(this).data("index"))});E.fixPositionCapture=function(){if(E.visible){E.fixPosition()}};D(window).on("resize.autocomplete",E.fixPositionCapture);E.el.on("keydown.autocomplete",function(J){E.onKeyPress(J)});E.el.on("keyup.autocomplete",function(J){E.onKeyUp(J)});E.el.on("blur.autocomplete",function(){E.onBlur()});E.el.on("focus.autocomplete",function(){E.onFocus()});E.el.on("change.autocomplete",function(J){E.onKeyUp(J)});E.el.on("input.autocomplete",function(J){E.onKeyUp(J)})},onFocus:function(){var E=this;E.fixPosition();if(E.el.val().length>=E.options.minChars){E.onValueChange()}},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var E=this;if(E.currentRequest){E.currentRequest.abort();E.currentRequest=null}},setOptions:function(E){var F=this,G=F.options;D.extend(G,E);F.isLocal=D.isArray(G.lookup);if(F.isLocal){G.lookup=F.verifySuggestionsFormat(G.lookup)}G.orientation=F.validateOrientation(G.orientation,"bottom");D(F.suggestionsContainer).css({"max-height":G.maxHeight+"px","width":G.width+"px","z-index":G.zIndex})},clearCache:function(){this.cachedResponse={};this.badQueries=[]},clear:function(){this.clearCache();this.currentValue="";this.suggestions=[]},disable:function(){var E=this;E.disabled=true;clearInterval(E.onChangeInterval);E.abortAjax()},enable:function(){this.disabled=false},fixPosition:function(){var N=this,O=D(N.suggestionsContainer),E=O.parent().get(0);if(E!==document.body&&!N.options.forceFixPosition){return}var L=N.options.orientation,H=O.outerHeight(),R=N.el.outerHeight(),G=N.el.offset(),I={"top":G.top,"left":G.left};if(L==="auto"){var P=D(window).height(),K=D(window).scrollTop(),J=-K+G.top-H,M=K+P-(G.top+R+H);L=(Math.max(J,M)===J)?"top":"bottom"}if(L==="top"){I.top+=-H}else{I.top+=R}if(E!==document.body){var F=O.css("opacity"),Q;if(!N.visible){O.css("opacity",0).show()}Q=O.offsetParent().offset();I.top-=Q.top;I.left-=Q.left;if(!N.visible){O.css("opacity",F).hide()}}if(N.options.width==="auto"){I.width=(N.el.outerWidth()-2)+"px"}O.css(I)},enableKillerFn:function(){var E=this;D(document).on("click.autocomplete",E.killerFn)},disableKillerFn:function(){var E=this;D(document).off("click.autocomplete",E.killerFn)},killSuggestions:function(){var E=this;E.stopKillSuggestions();E.intervalId=window.setInterval(function(){if(E.visible){E.el.val(E.currentValue);E.hide()}E.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var F=this,E=F.el.val().length,H=F.element.selectionStart,G;if(typeof H==="number"){return H===E}if(document.selection){G=document.selection.createRange();G.moveStart("character",-E);return E===G.text.length}return true},onKeyPress:function(E){var F=this;if(!F.disabled&&!F.visible&&E.which===C.DOWN&&F.currentValue){F.suggest();return}if(F.disabled||!F.visible){return}switch(E.which){case C.ESC:F.el.val(F.currentValue);F.hide();break;case C.RIGHT:if(F.hint&&F.options.onHint&&F.isCursorAtEnd()){F.selectHint();break}return;case C.TAB:if(F.hint&&F.options.onHint){F.selectHint();return}if(F.selectedIndex===-1){F.hide();return}F.select(F.selectedIndex);if(F.options.tabDisabled===false){return}break;case C.RETURN:if(F.selectedIndex===-1){F.hide();return}F.select(F.selectedIndex);break;case C.UP:F.moveUp();break;case C.DOWN:F.moveDown();break;default:return}E.stopImmediatePropagation();E.preventDefault()},onKeyUp:function(E){var F=this;if(F.disabled){return}switch(E.which){case C.UP:case C.DOWN:return}clearInterval(F.onChangeInterval);if(F.currentValue!==F.el.val()){F.findBestHint();if(F.options.deferRequestBy>0){F.onChangeInterval=setInterval(function(){F.onValueChange()},F.options.deferRequestBy)}else{F.onValueChange()}}},onValueChange:function(){var E=this,F=E.options,H=E.el.val(),G=E.getQuery(H);if(E.selection&&E.currentValue!==G){E.selection=null;(F.onInvalidateSelection||D.noop).call(E.element)}clearInterval(E.onChangeInterval);E.currentValue=H;E.selectedIndex=-1;if(F.triggerSelectOnValidInput&&E.isExactMatch(G)){E.select(0);return}if(G.length<F.minChars){E.hide()}else{E.getSuggestions(G)}},isExactMatch:function(E){var F=this.suggestions;return(F.length===1&&F[0].value.toLowerCase()===E.toLowerCase())},getQuery:function(F){var G=this.options.delimiter,E;if(!G){return F}E=F.split(G);return D.trim(E[E.length-1])},getSuggestionsLocal:function(H){var F=this,G=F.options,K=H.toLowerCase(),J=G.lookupFilter,E=parseInt(G.lookupLimit,10),I;I={suggestions:D.grep(G.lookup,function(L){return J(L,H,K)})};if(E&&I.suggestions.length>E){I.suggestions=I.suggestions.slice(0,E)}return I},getSuggestions:function(F){var L,K=this,J=K.options,G=J.serviceUrl,I,E,H;J.params[J.paramName]=F;I=J.ignoreParams?null:J.params;if(J.onSearchStart.call(K.element,J.params)===false){return}if(D.isFunction(J.lookup)){J.lookup(F,function(M){K.suggestions=M.suggestions;K.suggest();J.onSearchComplete.call(K.element,F,M.suggestions)});return}if(K.isLocal){L=K.getSuggestionsLocal(F)}else{if(D.isFunction(G)){G=G.call(K.element,F)}E=G+"?"+D.param(I||{});L=K.cachedResponse[E]}if(L&&D.isArray(L.suggestions)){K.suggestions=L.suggestions;K.suggest();J.onSearchComplete.call(K.element,F,L.suggestions)}else{if(!K.isBadQuery(F)){K.abortAjax();H={url:G,data:I,type:J.type,dataType:J.dataType};D.extend(H,J.ajaxSettings);K.currentRequest=D.ajax(H).done(function(N){var M;K.currentRequest=null;M=J.transformResult(N,F);K.processResponse(M,F,E);J.onSearchComplete.call(K.element,F,M.suggestions)}).fail(function(M,O,N){J.onSearchError.call(K.element,F,M,O,N)})}else{J.onSearchComplete.call(K.element,F,[])}}},isBadQuery:function(F){if(!this.options.preventBadQueries){return false}var G=this.badQueries,E=G.length;while(E--){if(F.indexOf(G[E])===0){return true}}return false},hide:function(){var E=this,F=D(E.suggestionsContainer);if(D.isFunction(E.options.onHide)&&E.visible){E.options.onHide.call(E.element,F)}E.visible=false;E.selectedIndex=-1;clearInterval(E.onChangeInterval);D(E.suggestionsContainer).hide();E.signalHint(null)},suggest:function(){if(this.suggestions.length===0){if(this.options.showNoSuggestionNotice){this.noSuggestions()}else{this.hide()}return}var M=this,K=M.options,J=K.groupBy,E=K.formatResult,I=M.getQuery(M.currentValue),O=M.classes.suggestion,N=M.classes.selected,L=D(M.suggestionsContainer),G=D(M.noSuggestionsContainer),H=K.beforeRender,P="",F,Q=function(S,T){var R=S.data[J];if(F===R){return""}F=R;return'<div class="autocomplete-group"><strong>'+F+"</strong></div>"};if(K.triggerSelectOnValidInput&&M.isExactMatch(I)){M.select(0);return}D.each(M.suggestions,function(R,S){if(J){P+=Q(S,I,R)}P+='<div class="'+O+'" data-index="'+R+'">'+E(S,I)+"</div>"});this.adjustContainerWidth();G.detach();L.html(P);if(D.isFunction(H)){H.call(M.element,L)}M.fixPosition();L.show();if(K.autoSelectFirst){M.selectedIndex=0;L.scrollTop(0);L.children("."+O).first().addClass(N)}M.visible=true;M.findBestHint()},noSuggestions:function(){var E=this,F=D(E.suggestionsContainer),G=D(E.noSuggestionsContainer);this.adjustContainerWidth();G.detach();F.empty();F.append(G);E.fixPosition();F.show();E.visible=true},adjustContainerWidth:function(){var E=this,F=E.options,G,H=D(E.suggestionsContainer);if(F.width==="auto"){G=E.el.outerWidth()-2;H.width(G>0?G:300)}},findBestHint:function(){var E=this,G=E.el.val().toLowerCase(),F=null;if(!G){return}D.each(E.suggestions,function(H,I){var J=I.value.toLowerCase().indexOf(G)===0;if(J){F=I}return !J});E.signalHint(F)},signalHint:function(G){var E="",F=this;if(G){E=F.currentValue+G.value.substr(F.currentValue.length)}if(F.hintValue!==E){F.hintValue=E;F.hint=G;(this.options.onHint||D.noop)(E)}},verifySuggestionsFormat:function(E){if(E.length&&typeof E[0]==="string"){return D.map(E,function(F){return{value:F,data:null}})}return E},validateOrientation:function(E,F){E=D.trim(E||"").toLowerCase();if(D.inArray(E,["auto","bottom","top"])===-1){E=F}return E},processResponse:function(F,I,E){var G=this,H=G.options;F.suggestions=G.verifySuggestionsFormat(F.suggestions);if(!H.noCache){G.cachedResponse[E]=F;if(H.preventBadQueries&&F.suggestions.length===0){G.badQueries.push(I)}}if(I!==G.getQuery(G.currentValue)){return}G.suggestions=F.suggestions;G.suggest()},activate:function(I){var G=this,E,J=G.classes.selected,H=D(G.suggestionsContainer),F=H.find("."+G.classes.suggestion);H.find("."+J).removeClass(J);G.selectedIndex=I;if(G.selectedIndex!==-1&&F.length>G.selectedIndex){E=F.get(G.selectedIndex);D(E).addClass(J);return E}return null},selectHint:function(){var F=this,E=D.inArray(F.hint,F.suggestions);F.select(E)},select:function(E){var F=this;F.hide();F.onSelect(E)},moveUp:function(){var E=this;if(E.selectedIndex===-1){return}if(E.selectedIndex===0){D(E.suggestionsContainer).children().first().removeClass(E.classes.selected);E.selectedIndex=-1;E.el.val(E.currentValue);E.findBestHint();return}E.adjustScroll(E.selectedIndex-1)},moveDown:function(){var E=this;if(E.selectedIndex===(E.suggestions.length-1)){return}E.adjustScroll(E.selectedIndex+1)},adjustScroll:function(I){var G=this,E=G.activate(I);if(!E){return}var H,K,F,J=D(E).outerHeight();H=E.offsetTop;K=D(G.suggestionsContainer).scrollTop();F=K+G.options.maxHeight-J;if(H<K){D(G.suggestionsContainer).scrollTop(H)}else{if(H>F){D(G.suggestionsContainer).scrollTop(H-G.options.maxHeight+J)}}if(!G.options.preserveInput){G.el.val(G.getValue(G.suggestions[I].value))}G.signalHint(null)},onSelect:function(H){var F=this,E=F.options.onSelect,G=F.suggestions[H];F.currentValue=F.getValue(G.value);if(F.currentValue!==F.el.val()&&!F.options.preserveInput){F.el.val(F.currentValue)}F.signalHint(null);F.suggestions=[];F.selection=G;if(D.isFunction(E)){E.call(F.element,G)}},getValue:function(H){var F=this,I=F.options.delimiter,G,E;if(!I){return H}G=F.currentValue;E=G.split(I);if(E.length===1){return H}return G.substr(0,G.length-E[E.length-1].length)+H},dispose:function(){var E=this;E.el.off(".autocomplete").removeData("autocomplete");E.disableKillerFn();D(window).off("resize.autocomplete",E.fixPositionCapture);D(E.suggestionsContainer).remove()}};D.fn.autocomplete=D.fn.devbridgeAutocomplete=function(F,G){var E="autocomplete";if(arguments.length===0){return this.first().data(E)}return this.each(function(){var I=D(this),H=I.data(E);if(typeof F==="string"){if(H&&typeof H[F]==="function"){H[F](G)}}else{if(H&&H.dispose){H.dispose()}H=new A(this,F);I.data(E,H)}})}}));