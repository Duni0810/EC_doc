/*
 * artTemplate - Template Engine
 * https://github.com/aui/artTemplate
 * Released under the MIT, BSD, and GPL Licenses
 */
(function(D){var E=function(H,G){return E[typeof G==="string"?"compile":"render"].apply(E,arguments)};E.version="2.0.4";E.openTag="<%";E.closeTag="%>";E.isEscape=true;E.isCompress=false;E.parser=null;E.render=function(I,H){var G=E.get(I)||A({id:I,name:"Render Error",message:"No Template"});return G(H)};E.compile=function(M,H){var L=arguments;var I=L[2];var J="anonymous";if(typeof H!=="string"){I=L[1];H=L[0];M=J}try{var K=B(M,H,I)}catch(G){G.id=M||H;G.name="Syntax Error";return A(G)}function N(P){try{return new K(P,M)+""}catch(O){if(!I){return E.compile(M,H,true)(P)}return A(O)()}}N.prototype=K.prototype;N.toString=function(){return K.toString()};if(M!==J){F[M]=N}return N};var F=E.cache={};var C=E.helpers=(function(){var J=function(M,L){if(typeof M!=="string"){L=typeof M;if(L==="number"){M+=""}else{if(L==="function"){M=J(M.call(M))}else{M=""}}}return M};var H={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};var K=function(L){return J(L).replace(/&(?![\w#]+;)|[<>"']/g,function(M){return H[M]})};var I=Array.isArray||function(L){return({}).toString.call(L)==="[object Array]"};var G=function(O,L){if(I(O)){for(var M=0,N=O.length;M<N;M++){L.call(O,O[M],M,O)}}else{for(M in O){L.call(O,O[M],M)}}};return{$include:E.render,$string:J,$escape:K,$each:G}})();E.helper=function(G,H){C[G]=H};E.onerror=function(G){var I="Template Error\n\n";for(var H in G){I+="<"+H+">\n"+G[H]+"\n\n"}if(D.console){console.error(I)}};E.get=function(J){var G;if(F.hasOwnProperty(J)){G=F[J]}else{if("document" in D){var I=document.getElementById(J);if(I){var H=I.value||I.innerHTML;G=E.compile(J,H.replace(/^\s*|\s*$/g,""))}}}return G};var A=function(G){E.onerror(G);return function(){return"{Template Error}"}};var B=(function(){var K=C.$each;var G="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined";var H=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var N=/[^\w$]+/g;var I=new RegExp(["\\b"+G.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var J=/^\d[^,]*|,\d[^,]*/g;var L=/^,+|,+$/g;var M=function(O){return O.replace(H,"").replace(N,",").replace(I,"").replace(J,"").replace(L,"").split(/^$|,+/)};return function(h,d,U){var l=E.openTag;var P=E.closeTag;var Q=E.parser;var X=d;var Y="";var T=1;var m={$data:1,$id:1,$helpers:1,$out:1,$line:1};var Z={};var c="var $helpers=this,"+(U?"$line=0,":"");var R="".trim;var S=R?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"];var a=R?"$out+=$text;return $text;":"$out.push($text);";var W="function($text){"+a+"}";var O="function(id,data){data=data||$data;var $text=$helpers.$include(id,data,$id);"+a+"}";K(X.split(l),function(n){n=n.split(P);var o=n[0];var e=n[1];if(n.length===1){Y+=b(o)}else{Y+=V(o);if(e){Y+=b(e)}}});X=Y;if(U){X="try{"+X+"}catch(e){throw {id:$id,name:'Render Error',message:e.message,line:$line,source:"+j(d)+".split(/\\n/)[$line-1].replace(/^[\\s\\t]+/,'')};}"}X=c+S[0]+X+"return new String("+S[3]+");";try{var f=new Function("$data","$id",X);f.prototype=Z;return f}catch(i){i.temp="function anonymous($data,$id) {"+X+"}";throw i}function b(e){T+=e.split(/\n/).length-1;if(E.isCompress){e=e.replace(/[\n\r\t\s]+/g," ").replace(/<!--.*?-->/g,"")}if(e){e=S[1]+j(e)+S[2]+"\n"}return e}function V(o){var e=T;if(Q){o=Q(o)}else{if(U){o=o.replace(/\n/g,function(){T++;return"$line="+T+";"})}}if(o.indexOf("=")===0){var n=!/^=[=#]/.test(o);o=o.replace(/^=[=#]?|[\s;]*$/g,"");if(n&&E.isEscape){var p=o.replace(/\s*\([^\)]+\)/,"");if(!C.hasOwnProperty(p)&&!/^(include|print)$/.test(p)){o="$escape("+o+")"}}else{o="$string("+o+")"}o=S[1]+o+S[2]}if(U){o="$line="+e+";"+o}g(o);return o+"\n"}function g(e){e=M(e);K(e,function(n){if(n&&!m.hasOwnProperty(n)){k(n);m[n]=true}})}function k(e){var n;if(e==="print"){n=W}else{if(e==="include"){Z["$include"]=C["$include"];n=O}else{n="$data."+e;if(C.hasOwnProperty(e)){Z[e]=C[e];if(e.indexOf("$")===0){n="$helpers."+e}else{n=n+"===undefined?$helpers."+e+":"+n}}}}c+=e+"="+n+","}function j(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}}})();if(typeof define==="function"){define(function(){return E})}else{if(typeof exports!=="undefined"){module.exports=E}}D.template=E})(this);